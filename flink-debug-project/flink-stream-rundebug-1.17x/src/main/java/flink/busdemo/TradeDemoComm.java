package flink.busdemo;

import flink.debug.FlinkSqlTableCommon;
import flink.debug.pressure.SimpleSource;
import org.apache.flink.api.common.functions.FlatMapFunction;
import org.apache.flink.api.common.typeinfo.TypeInformation;
import org.apache.flink.contrib.streaming.state.RocksDBStateBackend;
import org.apache.flink.runtime.state.filesystem.FsStateBackend;
import org.apache.flink.streaming.api.CheckpointingMode;
import org.apache.flink.streaming.api.datastream.DataStream;
import org.apache.flink.streaming.api.datastream.DataStreamSource;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.types.Row;
import org.apache.flink.util.Collector;

import java.math.BigDecimal;
import java.nio.file.Path;

/**
 * @projectName: FiveMinutesAbcData
 * @className: FlinkTableExample
 * @description: flink.debug.tableapi.FlinkTableExample
 * @author: jiaqing.he
 * @date: 2023/7/27 10:26
 * @version: 1.0
 */
public class TradeDemoComm extends FlinkSqlTableCommon {

    @Override
    protected String getBootstrapServers() {
        return "192.168.51.112:9092";
    }

    protected String getPaimonPath() {
        return "file:/tmp/paimon_f117";
    }

    protected String getTemplateJson() {
        return "[\n" +
                "{\n" +
                "  \"msgId\":\"PktUp_2_短 282574499909166\",\n" +
                "  \"message\":\"2023-07-17 13:25:53.015798 msg : [msg_no:7390700: ver:2]<AgwMsgExtQueryAssetDebts:<AgwMsgExtQueryBase:<cust_id=\\\"03000051380130  \\\"|fund_account_id=\\\"03*****44\\\"|account_id=\\\"            \\\"|client_seq_id=16******3|client_feature_code=\\\"PC;IIP=113.204.232.50;IPORT=53607;LIP=172.21.1.148;MAC=8CEC4B7A836E;HD=WD-WCC6Y7UA6HRY;CPU=HZ__BFEBFBFF000906E9@XUNTOU-PB;V1.0.1.9524\\\"|user_info=\\\"                                                                \\\"|password=\\\"5e44e0b1080c5bfa07bcb720292167a808c9755a403f7fdc05322d16b7092baa\\\"|branch_id=\\\"3**2      \\\"|>currency=\\\"    \\\"|>PktUpIoReserve:<agw_seq_id=282574499909166|agw_user=\\\"user133\\\"|>\\n\",\n" +
                "  \"timestamp\":1689910795618,\n" +
                "  \"version\":\"1.0\",\n" +
                "  \"@timestamp\": \"2023-07-17T13:25:54.457798Z\",\n" +
                "  \"offset\": 109329323,\n" +
                "  \"source\": \"/abc/agw/wex/file/AGG_53_32_20230717_14523.txt\"\n" +
                "}\n" +
                ",\n" +
                "{\n" +
                "  \"msgId\":\"PktDown_2_超长_60compatible 282574499909166\",\n" +
                "  \"message\":\"2023-07-17 13:25:56.622133 msg : [msg_no:310003: ver:2]<AgwMsgExtQueryResultTradeOrder:<AgwMsgExtQueryResultBase:<cust_id=\\\"03000051380130  \\\"|fund_account_id=\\\"0332020010780937\\\"|client_seq_id=2981382966844998718|query_result_code=0|user_info=\\\"RZ                                                              \\\"|branch_id=\\\"3202      \\\"|key_error_msg=\\\"\\\"|key_error_code=\\\"\\\"|key_error_level=0|>last_index=2849|total_num=6266|<compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000022989751                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102343640|last_px=123900|last_qty=160000|total_value_traded=198240000|fee=237900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000022990159                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102343800|last_px=123900|last_qty=240000|total_value_traded=297360000|fee=356900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000022990174                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102343800|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44600|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000022992020                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102344300|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000022995114                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102345280|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023004697                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102348050|last_px=123900|last_qty=3160000|total_value_traded=3915240000|fee=4698200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023009556                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102349670|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023009559                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102349670|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44600|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023052814                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102401900|last_px=123900|last_qty=1340000|total_value_traded=1660260000|fee=1992400|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023271600                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102505490|last_px=123900|last_qty=160000|total_value_traded=198240000|fee=237800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023271885                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102505580|last_px=123900|last_qty=150000|total_value_traded=185850000|fee=223100|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023272052                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102505650|last_px=123900|last_qty=90000|total_value_traded=111510000|fee=133800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023275807                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102506760|last_px=123900|last_qty=260000|total_value_traded=322140000|fee=386500|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023276106                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102506880|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023297459                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102513010|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312395                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516570|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312533                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516600|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382185                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537280|last_px=123900|last_qty=290000|total_value_traded=359310000|fee=431100|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382565                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537370|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661264                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651230|last_px=123900|last_qty=3200000|total_value_traded=3964800000|fee=4757700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661298                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661301                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661304                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661307                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661310                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661313                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661316                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661319                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661322                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023276106                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102506880|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023297459                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102513010|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312395                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516570|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312533                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516600|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382185                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537280|last_px=123900|last_qty=290000|total_value_traded=359310000|fee=431100|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382565                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537370|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661264                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651230|last_px=123900|last_qty=3200000|total_value_traded=3964800000|fee=4757700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661298                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661301                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661304                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661307                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661310                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661313                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661316                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661319                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661322                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023276106                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102506880|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023297459                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102513010|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312395                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516570|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312533                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516600|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382185                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537280|last_px=123900|last_qty=290000|total_value_traded=359310000|fee=431100|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382565                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537370|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661264                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651230|last_px=123900|last_qty=3200000|total_value_traded=3964800000|fee=4757700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661298                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661301                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661304                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661307                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661310                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661313                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661316                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661319                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661322                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023276106                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102506880|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023297459                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102513010|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312395                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516570|last_px=123900|last_qty=140000|total_value_traded=173460000|fee=208200|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023312533                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102516600|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382185                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537280|last_px=123900|last_qty=290000|total_value_traded=359310000|fee=431100|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023382565                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102537370|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661264                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651230|last_px=123900|last_qty=3200000|total_value_traded=3964800000|fee=4757700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661298                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661301                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661304                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661307                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=30000|total_value_traded=37170000|fee=44700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661310                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661313                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661316                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661319                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661322                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14800|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661325                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661328                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=10000|total_value_traded=12390000|fee=14900|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661331                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=50000|total_value_traded=61950000|fee=74400|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661334                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=50000|total_value_traded=61950000|fee=74400|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|><compatible=1>AgwTradeOrderArray:<business_type=200|security_id=\\\"002527  \\\"|security_symbol=\\\"新时达                               \\\"|market_id=102|account_id=\\\"0605072485  \\\"|side=2|ord_type=2|exec_type=F|exec_id=\\\"0101000023661339                \\\"|cl_ord_no=610119709|order_id=\\\"0030RXWVAJ00RNN0\\\"|cl_ord_id=\\\"11000440IO\\\"|transact_time=20230717102651240|last_px=123900|last_qty=20000|total_value_traded=24780000|fee=29700|currency=\\\"CNY \\\"|order_price=123900|order_qty=30000000|bs_flag2=\\\"0S\\\"|user_info=\\\"RZ                                                              \\\"|credit_digest_id=u|match_type=0|orig_cl_ord_no=0|security_full_symbol=\\\"新时达                                                       \\\"|>>PktDownIoReserve:<agw_seq_id=282574499909166|>\",\n" +
                "  \"timestamp\":1689910795618,\n" +
                "  \"version\":\"1.0\",\n" +
                "  \"@timestamp\": \"2023-07-17T13:25:56.857798Z\",\n" +
                "  \"offset\": 109329323,\n" +
                "  \"source\": \"/abc/agw/wex/file/AGG_53_32_20230717_14523.txt\"\n" +
                "}\n" +
                "]\n";
    }

    private DataStreamSource<String> getSourceDStreamFromJsonCollect(StreamExecutionEnvironment env) {
        String templateJson = getTemplateJson().trim();
        DataStreamSource<String> source = env.addSource(new SimpleSource<>(-1, templateJson), TypeInformation.of(String.class));
        return source;
    }



    protected DataStream<Row> getRowDataFromSocket(StreamExecutionEnvironment env) throws Exception {
        if (null == env) {
            env = StreamExecutionEnvironment.getExecutionEnvironment();
            env.setParallelism(2);
            env.enableChangelogStateBackend(true);
            Path dirPath = getOrCreateDirFromUserDir("checkpoint-rocksdb");
            env.setStateBackend(new RocksDBStateBackend(dirPath.toUri().toString()));
            env.setStateBackend(new FsStateBackend(dirPath.toUri().toString()));
            env.enableCheckpointing(1000*3, CheckpointingMode.EXACTLY_ONCE);
        }

//        env.setStreamTimeCharacteristic(TimeCharacteristic.ProcessingTime);
        // Start,tid1001,cid201,2023-10-04T10:07:22.239,1
        // Close,tid1001,000,98.9,2023-10-04T10:07:23.768,4
        DataStreamSource<String> lines = env.socketTextStream("bdnode112", 9909);
        DataStream<Row> dataStream = lines
                .flatMap(new FlatMapFunction<String, Row>() {
                    @Override
                    public void flatMap(String line, Collector<Row> out) throws Exception {
                        if (null != line && !line.isEmpty()) {
                            String[] split = line.split(",");
                            if (split.length > 0) {
                                Row row;
                                if (split.length == 1) {
                                    String numStr = split[0].trim();
                                    Object num;
                                    try {
                                        num = Integer.parseInt(numStr);
                                    } catch (RuntimeException e) {
                                        try {
                                            num = new BigDecimal(numStr).doubleValue();
                                        } catch (RuntimeException e2) {
                                            num = numStr;
                                        }
                                    }
                                    row = Row.of(num);
                                } else {
                                    // 有key,
                                    row = new Row(split.length);
                                    for (int i = 0; i < split.length; i++) {
                                        String ele = split[i];
                                        row.setField(i, ele);
                                    }
                                }
                                // 输出
                                try {
                                    out.collect(row);
                                } catch (RuntimeException e) {
                                    e.printStackTrace();
                                }
                            }
                        }
                    }
                })

        ;

        return dataStream;
    }


}
